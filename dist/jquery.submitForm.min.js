!function(t){var e=["INPUT","SELECT","TEXTAREA"],n={processing:"processing",error:"error",success:"success"},i=[37,39,8,46,13,10,36,35,9],a=[],s={required:function(e){var n="radio"===e.type||"checkbox"===e.type?e.checked:t(e).val().trim();return n||t(e).addClass("invalid"),!!n},phone:function(e){var n=t(e).val(),i=!0;return(!/^[0-9()\-+\s]+$/.test(n)||n.length<6)&&(t(e).addClass("invalid"),i=!1),i},email:function(e){var n=t(e).val(),i=!0;return n&&!/^[а-яА-Яa-zA-Z0-9.!#$%&’*+\/=?^_`{|}~-]+@[а-яА-Яa-zA-Z0-9-]+(?:\.[а-яА-Яa-zA-Z0-9-]+)*$/i.test(n)&&(t(e).addClass("invalid"),i=!1),i},date:function(e){var n=t(e).val(),i=!0;if(n){var a=n.split("."),s=new Date(a[2],a[1]-1,a[0],0,0,0,0);(i=!isNaN(s.getTime())&&parseInt(a[1])===s.getMonth()+1)||t(e).addClass("invalid")}return i},minlength:function(e){var n=t(e).attr("minlength"),i=!0;return t(e).val().length<n&&(i=!1,t(e).addClass("invalid")),i},number:function(e){var n=t(e).val(),i=!0;return n&&!/^\d+$/.test(n)&&(t(e).addClass("invalid"),i=!1),i}};function o(n){return t(n.children).each(function(n,i){-1===t.inArray(i.nodeName,e)||i.disabled||a.push(i),i.childElementCount&&o(i)}),a}function r(e){var n=t(e).attr("data-validate");if(t(e).removeClass("invalid"),t(e).removeClass("valid"),n){for(var i=n.split(", "),a=0;validator=i[a];a++){var o=s[validator];if(t(e).removeClass("invalid"),valid=o(e),!valid)return t(e).focus(),t(this).addClass("invalid-"+validator),!1}if(!valid)return void 0!==this.options.invalidHandler&&this.options.invalidHandler(item),!1}return t(e).addClass("valid"),!0}function l(){var e=this;a=[],this.fields=o(this),t.each(s,function(n,i){t(e).removeClass("invalid-"+n)});for(var n=!1,i=0;i<a.length;i++){var l=this.fields[i];if(!(n=r.call(e,l)))break}return n}function d(){if(t.each(this.state,function(e,n){t(this).removeClass(n)}),l.call(this)){var e={};return t(this.fields).each(function(n,i){var a,s=i.name||i.id;"radio"!==i.type&&"checkbox"!==i.type||!i.checked||(a=t(i).val()),(/text|hidden|password|tel/.test(i.type)||"SELECT"===i.nodeName||"TEXTAREA"===i.nodeName)&&(a=t(i).val()),void 0!==a&&(e[s]?("object"!=typeof e[s]&&(e[s]=[e[s]]),e[s].push(a)):e[s]=a)}),e=this.options.prepare(e),this.options.ajax?(this.options.ajaxObject?this.options.ajaxObject.data=e:this.options.ajaxObject={url:this.options.source,type:this.options.method,data:e,beforeSend:this.options.onBeforeSend,success:this.options.onSuccess,error:this.options.onError},this.options.beforeSend(e)&&t.ajax(this.options.ajaxObject),!1):(this.options.onBeforeSend(),!0)}return!1}var c={init:function(e){return this.each(function(a,s){var l=t(s),c={ajaxObject:null,source:l.attr("action")||"/",method:l.attr("method")||"POST",ajax:!0,responseElement:t(this),onBeforeSend:function(t){l.addClass(s.state.processing)},onSuccess:function(t,e,n){l.removeClass(s.state.processing),l.addClass(s.state.success);var i=s.options.success&&s.options.success(t);(i||void 0===i)&&s.options.responseElement.html(t)},onError:function(t,e,n){l.removeClass(s.state.processing),l.addClass(s.state.error),(s.options.error?s.options.error(e,n):void 0)&&s.options.responseElement.html(n)},success:function(t){},prepare:function(t){return t},beforeSend:function(t){return!0}},u=t.extend({},c,e);s.options=u,l.submit(d),s.fields=o(s),s.state=e&&e.state?t.extend(n,e.state):n;var v=s;t.each(s.fields,function(e,n){t(n).keyup(function(e){t(n).removeClass("valid"),-1==i.indexOf(e.keyCode)&&v.options.validateOnEnter&&r.call(v,n)}),t(n).change(function(t){v.options.validateOnEnter&&r.call(v,n)})})})},loadData:function(e){this.fields=o(this),t.each(this.fields,function(n,i){e[i.name]&&t(i).val(e[i.name])})},validate:function(){l.call(this)}};t.fn.submitForm=function(e){return c[e]?c[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error('Method "'+e+'" not found!'):c.init.apply(this,arguments)}}($);